<view class="page-container">
  <!-- è®¢å•çŠ¶æ€å¡ç‰‡ -->
  <view class="status-card">
    <!-- å·²å…³é—­çŠ¶æ€ -->
    <view wx:if="{{orderDetail.orderInfo.status == -1}}" class="status-content status-closed">
      <view class="status-icon-wrapper">
        <van-icon name="close" size="100rpx" color="#fff" />
      </view>
      <view class="status-title">{{ $t.order.stausClosed }}</view>
      <view class="status-desc">è®¢å•å·²å–æ¶ˆ</view>
    </view>

    <!-- å¾…æ”¯ä»˜çŠ¶æ€ -->
    <view wx:if="{{orderDetail.orderInfo.status == 0}}" class="status-content status-unpay">
      <view class="status-icon-wrapper">
        <van-icon name="gold-coin-o" size="100rpx" color="#fff" />
      </view>
      <view class="status-title">{{ $t.order.stausNoPay }}</view>
      <view class="status-desc">è¯·å°½å¿«å®Œæˆæ”¯ä»˜</view>
      <view class="pay-btn-wrapper">
        <view class="pay-btn" bind:tap="toPayTap">{{ $t.order.toPayTap }}</view>
      </view>
    </view>

    <!-- å¾…å–é¤çŠ¶æ€ï¼ˆè‡ªæï¼‰ -->
    <view wx:if="{{orderDetail.orderInfo.status == 1 && !orderDetail.orderInfo.isNeedLogistics}}" class="status-content status-pickup">
      <view class="status-icon-wrapper">
        <van-icon name="shopping-cart-o" size="100rpx" color="#fff" />
      </view>
      <view class="status-title">ç­‰å¾…å–é¤</view>
      <view class="pickup-number-label">{{ $t.PickingUp.qudanhao }}</view>
      <view class="pickup-number">{{orderDetail.orderInfo.qudanhao}}</view>
      <view class="qrcode-wrapper">
        <view class="qrcode-container">
          <canvas class="qrcode-canvas" canvas-id="qrcode" />
        </view>
        <view class="qrcode-tip">å‡ºç¤ºæ­¤ç ç»™åº—å‘˜æ ¸é”€</view>
      </view>
    </view>

    <!-- é…é€ä¸­çŠ¶æ€ -->
    <view wx:if="{{(orderDetail.orderInfo.status == 1 || orderDetail.orderInfo.status == 2) && orderDetail.orderInfo.isNeedLogistics}}" class="status-content status-delivery">
      <view class="status-icon-wrapper">
        <van-icon name="logistics" size="100rpx" color="#fff" />
      </view>
      <view class="status-title">{{ $t.PickingUp.Deliverying }}</view>
      <view class="status-desc">éª‘æ‰‹æ­£åœ¨ç«é€Ÿé…é€ä¸­</view>
      <view class="qrcode-wrapper">
        <view class="qrcode-container">
          <canvas class="qrcode-canvas" canvas-id="qrcode" />
        </view>
        <view class="qrcode-tip">å‡ºç¤ºæ­¤ç ç»™éª‘æ‰‹</view>
      </view>
    </view>

    <!-- å·²å®ŒæˆçŠ¶æ€ -->
    <view wx:if="{{orderDetail.orderInfo.status == 3 || orderDetail.orderInfo.status == 4}}" class="status-content status-success">
      <view class="status-icon-wrapper">
        <van-icon name="passed" size="100rpx" color="#fff" />
      </view>
      <view class="status-title">{{ $t.order.stausSuccess }}</view>
      <view class="status-desc">æ„Ÿè°¢æ‚¨çš„å…‰ä¸´ï¼ŒæœŸå¾…å†æ¬¡ä¸ºæ‚¨æœåŠ¡</view>
    </view>
  </view>

  <!-- åº—é“ºä¿¡æ¯å¡ç‰‡ -->
  <view wx:if="{{shopSubdetail}}" class="shop-card">
    <view class="card-header">
      <view class="header-icon">ğŸª</view>
      <view class="header-title">åº—é“ºä¿¡æ¯</view>
    </view>
    <view class="shop-info">
      <view class="shop-main">
        <view class="shop-name">{{shopSubdetail.info.name}}</view>
        <view class="shop-address">{{shopSubdetail.info.address}}</view>
      </view>
      <view class="shop-phone" bind:tap="callshop">
        <van-icon name="phone-circle-o" size="48rpx" color="#8B4513" />
        <view class="phone-text">è”ç³»</view>
      </view>
    </view>
  </view>

  <!-- æ”¶è´§åœ°å€å¡ç‰‡ -->
  <view wx:if="{{orderDetail.logistics}}" class="address-card">
    <view class="card-header">
      <view class="header-icon">ğŸ“</view>
      <view class="header-title">æ”¶è´§ä¿¡æ¯</view>
    </view>
    <view class="address-info">
      <view class="address-user">
        <view class="user-name">{{orderDetail.logistics.linkMan}}</view>
        <view class="user-phone">{{orderDetail.logistics.mobile}}</view>
      </view>
      <view class="address-detail">{{orderDetail.logistics.provinceStr}}{{orderDetail.logistics.cityStr}}{{orderDetail.logistics.areaStr}}{{orderDetail.logistics.address}}</view>
    </view>
  </view>

  <!-- å•†å“ä¿¡æ¯å¡ç‰‡ -->
  <view class="goods-card">
    <view class="card-header">
      <view class="header-icon">ğŸ¥¤</view>
      <view class="header-title">è®¢å•å•†å“</view>
    </view>
    <view class="goods-list">
      <view wx:for="{{orderDetail.goods}}" wx:key="id" class="goods-item">
        <view class="goods-info">
          <view class="goods-name">{{item.goodsName}}</view>
          <view wx:if="{{item.property}}" class="goods-spec">{{item.property}}</view>
        </view>
        <view class="goods-right">
          <view class="goods-price">Â¥{{item.amount}}</view>
          <view class="goods-num">x{{item.number}}</view>
        </view>
      </view>
    </view>
    
    <view class="goods-divider"></view>
    
    <view class="goods-total">
      <view class="total-label">{{ $t.PickingUp.total }}</view>
      <view class="total-price">Â¥{{orderDetail.orderInfo.amountReal}}</view>
    </view>
  </view>

  <!-- è®¢å•ä¿¡æ¯å¡ç‰‡ -->
  <view class="order-info-card">
    <view class="card-header">
      <view class="header-icon">ğŸ“‹</view>
      <view class="header-title">è®¢å•ä¿¡æ¯</view>
    </view>
    <view class="info-list">
      <view class="info-item">
        <view class="info-label">{{ $t.order.dateAdd }}</view>
        <view class="info-value">{{orderDetail.orderInfo.dateAdd}}</view>
      </view>
      <view wx:if="{{orderDetail.orderInfo.status == -1}}" class="info-item">
        <view class="info-label">{{ $t.common.cancel }}</view>
        <view class="info-value">{{orderDetail.orderInfo.dateClose}}</view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨å®‰å…¨è·ç¦» -->
  <view class="safe-bottom"></view>
</view>

<payment
  money="{{ money }}"
  remark="{{ $t.payment.order }} ï¼š{{ orderId }}"
  nextAction="{{ nextAction }}"
  show="{{ paymentShow }}"
  bind:cancel="paymentCancel"
  bind:ok="paymentOk"
/>